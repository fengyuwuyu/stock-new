<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.bdtd.card.data.stock.dao.CurrentIncreaseMapper">

    <!-- 通用查询映射结果 -->
    <resultMap id="BaseResultMap" type="com.bdtd.card.data.stock.model.CurrentIncrease">
        <id column="id" property="id" />
        <result column="symbol" property="symbol" />
        <result column="name" property="name" />
        <result column="code" property="code" />
        <result column="max" property="max" />
        <result column="min" property="min" />
        <result column="increase" property="increase" />
        <result column="two_increase" property="twoIncrease" />
        <result column="thress_increase" property="thressIncrease" />
        <result column="four_increase" property="fourIncrease" />
        <result column="five_increase" property="fiveIncrease" />
        <result column="ten_increase" property="tenIncrease" />
        <result column="fifteen_increase" property="fifteenIncrease" />
        <result column="twenty_increase" property="twentyIncrease" />
        <result column="max_increase" property="maxIncrease" />
        <result column="increases" property="increases" />
        <result column="volumes" property="volumes" />
        <result column="future_five_day_increase" property="futureFiveDayIncrease" />
        <result column="future_ten_day_increase" property="futureTenDayIncrease" />
        <result column="future_fifteen_day_increase" property="futureFifteenDayIncrease" />
        <result column="future_twenty_day_increase" property="futureTwentyDayIncrease" />
        <result column="future_increases" property="futureIncreases" />
        <result column="future_volumes" property="futureVolumes" />
        <result column="day_volume_avg" property="dayVolumeAvg" />
        <result column="two_volume_avg" property="twoVolumeAvg" />
        <result column="three_volume_avg" property="threeVolumeAvg" />
        <result column="four_volume_avg" property="fourVolumeAvg" />
        <result column="five_volume_avg" property="fiveVolumeAvg" />
        <result column="first_level_day" property="firstLevelDay" />
        <result column="first_level_increase" property="firstLevelIncrease" />
        <result column="second_level_day" property="secondLevelDay" />
        <result column="second_level_increase" property="secondLevelIncrease" />
        <result column="third_level_day" property="thirdLevelDay" />
        <result column="third_level_increase" property="thirdLevelIncrease" />
        <result column="four_level_day" property="fourLevelDay" />
        <result column="four_level_increase" property="fourLevelIncrease" />
        <result column="five_level_day" property="fiveLevelDay" />
        <result column="five_level_increase" property="fiveLevelIncrease" />
        <result column="stock_type" property="stockType" />
        <result column="msa_day" property="msaDay" />
        <result column="volume" property="volume" />
        <result column="close" property="close" />
    </resultMap>
    <!-- 通用查询结果列 -->
    <sql id="Base_Column_List">
        id, symbol, name, code, max, min, increase, two_increase twoIncrease, thress_increase thressIncrease, four_increase fourIncrease, five_increase fiveIncrease, ten_increase tenIncrease, fifteen_increase fifteenIncrease, twenty_increase twentyIncrease, max_increase maxIncrease, increases, volumes, future_five_day_increase futureFiveDayIncrease, future_ten_day_increase futureTenDayIncrease, future_fifteen_day_increase futureFifteenDayIncrease, future_twenty_day_increase futureTwentyDayIncrease, future_increases futureIncreases, future_volumes futureVolumes, day_volume_avg dayVolumeAvg, two_volume_avg twoVolumeAvg, three_volume_avg threeVolumeAvg, four_volume_avg fourVolumeAvg, five_volume_avg fiveVolumeAvg, first_level_day firstLevelDay, first_level_increase firstLevelIncrease, second_level_day secondLevelDay, second_level_increase secondLevelIncrease, third_level_day thirdLevelDay, third_level_increase thirdLevelIncrease, four_level_day fourLevelDay, four_level_increase fourLevelIncrease, five_level_day fiveLevelDay, five_level_increase fiveLevelIncrease, stock_type stockType, msa_day msaDay, volume, close
    </sql>

	<!-- 关联查询结果列 -->
    <sql id="Base_Column_List_Prefix">
        a.id, a.symbol, a.name, a.code, a.max, a.min, a.increase, a.two_increase twoIncrease, a.thress_increase thressIncrease, a.four_increase fourIncrease, a.five_increase fiveIncrease, a.ten_increase tenIncrease, a.fifteen_increase fifteenIncrease, a.twenty_increase twentyIncrease, a.max_increase maxIncrease, a.increases, a.volumes, a.future_five_day_increase futureFiveDayIncrease, a.future_ten_day_increase futureTenDayIncrease, a.future_fifteen_day_increase futureFifteenDayIncrease, a.future_twenty_day_increase futureTwentyDayIncrease, a.future_increases futureIncreases, a.future_volumes futureVolumes, a.day_volume_avg dayVolumeAvg, a.two_volume_avg twoVolumeAvg, a.three_volume_avg threeVolumeAvg, a.four_volume_avg fourVolumeAvg, a.five_volume_avg fiveVolumeAvg, a.first_level_day firstLevelDay, a.first_level_increase firstLevelIncrease, a.second_level_day secondLevelDay, a.second_level_increase secondLevelIncrease, a.third_level_day thirdLevelDay, a.third_level_increase thirdLevelIncrease, a.four_level_day fourLevelDay, a.four_level_increase fourLevelIncrease, a.five_level_day fiveLevelDay, a.five_level_increase fiveLevelIncrease, a.stock_type stockType, a.msa_day msaDay,a.volume, a.close
    </sql>

	<insert id="insertAll" parameterType="java.util.List">
		insert into msa_current_increase(id, symbol, name, code, max, min, increase, two_increase, thress_increase, four_increase, five_increase, ten_increase, fifteen_increase, twenty_increase, max_increase, increases, volumes, future_five_day_increase, future_ten_day_increase, future_fifteen_day_increase, future_twenty_day_increase, future_increases, future_volumes, day_volume_avg, two_volume_avg, three_volume_avg, four_volume_avg, five_volume_avg, first_level_day, first_level_increase, second_level_day, second_level_increase, third_level_day, third_level_increase, four_level_day, four_level_increase, five_level_day, five_level_increase, stock_type, msa_day, volume, close) 
		values
		<foreach collection="list" item="item" separator=",">
			(#{item.id}, #{item.symbol}, #{item.name}, #{item.code}, #{item.max}, #{item.min}, #{item.increase}, #{item.twoIncrease}, #{item.thressIncrease}, #{item.fourIncrease}, #{item.fiveIncrease}, #{item.tenIncrease}, #{item.fifteenIncrease}, #{item.twentyIncrease}, #{item.maxIncrease}, #{item.increases}, #{item.volumes}, #{item.futureFiveDayIncrease}, #{item.futureTenDayIncrease}, #{item.futureFifteenDayIncrease}, #{item.futureTwentyDayIncrease}, #{item.futureIncreases}, #{item.futureVolumes}, #{item.dayVolumeAvg}, #{item.twoVolumeAvg}, #{item.threeVolumeAvg}, #{item.fourVolumeAvg}, #{item.fiveVolumeAvg}, #{item.firstLevelDay}, #{item.firstLevelIncrease}, #{item.secondLevelDay}, #{item.secondLevelIncrease}, #{item.thirdLevelDay}, #{item.thirdLevelIncrease}, #{item.fourLevelDay}, #{item.fourLevelIncrease}, #{item.fiveLevelDay}, #{item.fiveLevelIncrease}, #{item.stockType}, #{item.msaDay}, #{item.volume}, #{item.close})
		</foreach>
	</insert>
	
	<select id="countByQuery" parameterType="com.bdtd.card.data.stock.model.query.CurrentIncreaseQuery" resultType="long">
		select count(1) from msa_current_increase 
		<where>
			<trim suffixOverrides="and">
				<if test="symbol != null">
					symbol = #{symbol} and
				</if>
				<if test="stockType != null">
					stock_type = #{stockType} and
				</if>
				<if test="min != null and max != null">
					${sortField} between #{min} and #{max} and
				</if>
				<if test="min != null and max == null">
					${sortField} &gt;= #{min} and
				</if>
				<if test="min == null and max != null">
					${sortField} &lt;= #{max} and
				</if>
				<if test="end != null">
					msa_day = #{end}
				</if>
			</trim>
		</where>	
	</select>
	
	<select id="findByQuery" parameterType="com.bdtd.card.data.stock.model.query.CurrentIncreaseQuery" resultType="com.bdtd.card.data.stock.model.CurrentIncrease">
		select <include refid="Base_Column_List_Prefix"></include>, cast(left(b.code,1) as unsigned integer) stockCategory
		from msa_current_increase a
		left join stock b on a.symbol = b.symbol
		<where>
			<trim suffixOverrides="and">
				<if test="symbol != null">
					symbol = #{symbol} and
				</if>
				<if test="stockType != null">
					stock_type = #{stockType} and
				</if>
				<if test="min != null and max != null">
					${sortField} between #{min} and #{max} and
				</if>
				<if test="min != null and max == null">
					${sortField} &gt;= #{min} and
				</if>
				<if test="min == null and max != null">
					${sortField} &lt;= #{max} and
				</if>
				<if test="end != null">
					msa_day = #{end}
				</if>
			</trim>
		</where>	
		order by ${sortField} <if test="asc">asc</if><if test="!asc">desc</if>
		limit #{offset}, #{limit}
	</select>
</mapper>
